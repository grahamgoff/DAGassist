<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Recovering Estimands with DAGassist • DAGassist</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Recovering Estimands with DAGassist">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">DAGassist</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.2.7</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/grahamgoff/DAGassist" aria-label="GitHub"><span class="fa fab fa-github"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Recovering Estimands with DAGassist</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/grahamgoff/DAGassist/blob/dev/vignettes/estimand-recovery.Rmd" class="external-link"><code>vignettes/estimand-recovery.Rmd</code></a></small>
      <div class="d-none name"><code>estimand-recovery.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/grahamgoff/DAGassist" class="external-link">DAGassist</a></span><span class="op">)</span></span></code></pre></div>
<p>Researchers often include control variables to block backdoor paths.
Many interpret the resulting treatment coefficient as the
<code>average treatment effect (ATE)</code>. However, linear regression
and generalized linear model methods do not recover ATE by default.
Instead, they recover weighted strata-specific averages (Chattopadhyay
and Zubizarreta 2024). To bridge this gap, DAGassist automates estimand
recovery by constructing weights that align estimation with a
user-specified target estimand. This vignette illustrates the workflow
using a simulated dataset.</p>
<details><summary><strong>Dataset summary statistics (click to expand)</strong>
</summary><table class="table">
<colgroup>
<col width="19%">
<col width="9%">
<col width="9%">
<col width="11%">
<col width="11%">
<col width="12%">
<col width="12%">
<col width="13%">
</colgroup>
<thead><tr class="header">
<th align="left">variable</th>
<th align="left">type</th>
<th align="left">Min</th>
<th align="left">Q1</th>
<th align="left">Median</th>
<th align="left">Mean</th>
<th align="left">Q3</th>
<th align="left">Max</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">id</td>
<td align="left">integer</td>
<td align="left">1.00</td>
<td align="left">250.75</td>
<td align="left">500.50</td>
<td align="left">500.50</td>
<td align="left">750.25</td>
<td align="left">1000.00</td>
</tr>
<tr class="even">
<td align="left">year</td>
<td align="left">integer</td>
<td align="left">0.00</td>
<td align="left">1.00</td>
<td align="left">2.00</td>
<td align="left">2.00</td>
<td align="left">3.00</td>
<td align="left">4.00</td>
</tr>
<tr class="odd">
<td align="left">age</td>
<td align="left">numeric</td>
<td align="left">0.00</td>
<td align="left">27.60</td>
<td align="left">37.70</td>
<td align="left">37.76</td>
<td align="left">47.40</td>
<td align="left">86.20</td>
</tr>
<tr class="even">
<td align="left">pref</td>
<td align="left">numeric</td>
<td align="left">0.00</td>
<td align="left">1.35</td>
<td align="left">2.03</td>
<td align="left">2.06</td>
<td align="left">2.74</td>
<td align="left">4.94</td>
</tr>
<tr class="odd">
<td align="left">edu_year</td>
<td align="left">numeric</td>
<td align="left">0.00</td>
<td align="left">11.80</td>
<td align="left">13.10</td>
<td align="left">13.07</td>
<td align="left">15.20</td>
<td align="left">22.00</td>
</tr>
<tr class="even">
<td align="left">married</td>
<td align="left">integer</td>
<td align="left">0.00</td>
<td align="left">0.00</td>
<td align="left">1.00</td>
<td align="left">0.56</td>
<td align="left">1.00</td>
<td align="left">1.00</td>
</tr>
<tr class="odd">
<td align="left">birth_control</td>
<td align="left">integer</td>
<td align="left">0.00</td>
<td align="left">0.00</td>
<td align="left">1.00</td>
<td align="left">0.71</td>
<td align="left">1.00</td>
<td align="left">1.00</td>
</tr>
<tr class="even">
<td align="left">income</td>
<td align="left">numeric</td>
<td align="left">2344.00</td>
<td align="left">43141.75</td>
<td align="left">87560.50</td>
<td align="left">125387.86</td>
<td align="left">162098.50</td>
<td align="left">1817478.00</td>
</tr>
<tr class="odd">
<td align="left">children</td>
<td align="left">numeric</td>
<td align="left">0.00</td>
<td align="left">0.00</td>
<td align="left">0.00</td>
<td align="left">2.03</td>
<td align="left">3.00</td>
<td align="left">12.00</td>
</tr>
<tr class="even">
<td align="left">job_stability_t</td>
<td align="left">numeric</td>
<td align="left">-3.00</td>
<td align="left">-0.27</td>
<td align="left">0.55</td>
<td align="left">0.49</td>
<td align="left">1.29</td>
<td align="left">3.00</td>
</tr>
</tbody>
</table>
<table class="table">
<colgroup>
<col width="14%">
<col width="10%">
<col width="75%">
</colgroup>
<thead><tr class="header">
<th align="left">variable</th>
<th align="left">type</th>
<th align="left">top_levels</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">gender</td>
<td align="left">factor</td>
<td align="left">Male:2565 Female:2435</td>
</tr>
<tr class="even">
<td align="left">immigrant</td>
<td align="left">factor</td>
<td align="left">No:4380 Yes:620</td>
</tr>
<tr class="odd">
<td align="left">urban</td>
<td align="left">factor</td>
<td align="left">Urban:3560 Rural:1440</td>
</tr>
<tr class="even">
<td align="left">class</td>
<td align="left">ordered</td>
<td align="left">Working:2080 Middle:1580 Low:885 (Other):455</td>
</tr>
<tr class="odd">
<td align="left">religion</td>
<td align="left">factor</td>
<td align="left">Christian:2005 Unaffiliated:1725 Muslim:460
(Other):810</td>
</tr>
<tr class="even">
<td align="left">contract</td>
<td align="left">factor</td>
<td align="left">Temporary:1905 Permanent:1810 Informal:1285</td>
</tr>
<tr class="odd">
<td align="left">edu_degree</td>
<td align="left">factor</td>
<td align="left">HS_grad:1610 Some_college:1390 BA:975 (Other):1025</td>
</tr>
</tbody>
</table></details><pre><code><span><span class="co">#&gt; Warning: Removed 1 row containing missing values or values outside the scale range</span></span>
<span><span class="co">#&gt; (`geom_dag_point()`).</span></span></code></pre>
<div class="figure">
<img src="estimand-recovery_files/figure-html/example-dag-1.png" class="r-plt" alt="*Example: The Causal Effects of Family Background and Life Course Events on Fertility Patterns*" width="768"><p class="caption">
<em>Example: The Causal Effects of Family Background and Life Course
Events on Fertility Patterns</em>
</p>
</div>
<p>The DAG above visualizes a common social science question: how does
education affect fertility (Morgan and Winship, 17-19)? The DAG model
encodes a plausible, but not exhaustive, set of covariates. In the
report below, <code>DAGassist</code> classifies variables by their
causal roles, reestimates the model with DAG-consistent adjustment sets,
and recovers the <code>ATE</code> using weights.</p>
<p>Note: estimand recovery for binary treatments requires
<code>WeightIt</code>, and continuous treatments require
<code>twangContinuous</code>. The below model has years of education as
its treatment and therefore uses <code>twangContinuous</code> (see
descriptive statistics for details on covariates).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">twangContinuous</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/DAGassist.html">DAGassist</a></span><span class="op">(</span><span class="va">dag_model</span>,</span>
<span>          formula <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">children</span> <span class="op">~</span> <span class="va">edu_year</span> <span class="op">+</span> <span class="va">age</span> <span class="op">+</span> <span class="va">class</span> <span class="op">+</span> <span class="va">gender</span> <span class="op">+</span> </span>
<span>                         <span class="va">immigrant</span> <span class="op">+</span> <span class="va">urban</span> <span class="op">+</span> <span class="va">birth_control</span> <span class="op">+</span> <span class="va">income</span> <span class="op">+</span> </span>
<span>                         <span class="va">married</span> <span class="op">+</span> <span class="va">job_stability_t</span> <span class="op">+</span> <span class="va">contract</span> <span class="op">+</span> <span class="va">pref</span>, data <span class="op">=</span> <span class="va">dat</span><span class="op">)</span>,</span>
<span>          estimand <span class="op">=</span> <span class="st">"ATE"</span>,</span>
<span>          bivariate <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>          type<span class="op">=</span><span class="st">"txt"</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="dagassist-report">DAGassist Report:<a class="anchor" aria-label="anchor" href="#dagassist-report"></a>
</h2>
</div>
<div class="section level2">
<h2 id="roles">Roles<a class="anchor" aria-label="anchor" href="#roles"></a>
</h2>
<table class="table">
<colgroup>
<col width="13%">
<col width="10%">
<col width="5%">
<col width="5%">
<col width="5%">
<col width="5%">
<col width="5%">
<col width="6%">
<col width="6%">
<col width="6%">
<col width="7%">
<col width="8%">
<col width="5%">
<col width="5%">
</colgroup>
<thead><tr class="header">
<th align="left">Variable</th>
<th align="center">Role</th>
<th align="center">Exp.</th>
<th align="center">Out.</th>
<th align="center"><code>CON</code></th>
<th align="center"><code>MED</code></th>
<th align="center"><code>COL</code></th>
<th align="center"><code>dOut</code></th>
<th align="center"><code>dMed</code></th>
<th align="center"><code>dCol</code></th>
<th align="center">dConfOn</th>
<th align="center">dConfOff</th>
<th align="center"><code>NCT</code></th>
<th align="center"><code>NCO</code></th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">age</td>
<td align="center">confounder</td>
<td align="center"></td>
<td align="center"></td>
<td align="center">x</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="left">birth_control</td>
<td align="center">mediator</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">x</td>
<td align="center"></td>
<td align="center"></td>
<td align="center">x</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="left">children</td>
<td align="center">outcome</td>
<td align="center"></td>
<td align="center">x</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="left">class</td>
<td align="center">confounder</td>
<td align="center"></td>
<td align="center"></td>
<td align="center">x</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="left">contract</td>
<td align="center">confounder</td>
<td align="center"></td>
<td align="center"></td>
<td align="center">x</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="left">edu_year</td>
<td align="center">exposure</td>
<td align="center">x</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="left">gender</td>
<td align="center">confounder</td>
<td align="center"></td>
<td align="center"></td>
<td align="center">x</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="left">immigrant</td>
<td align="center">confounder</td>
<td align="center"></td>
<td align="center"></td>
<td align="center">x</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="left">income</td>
<td align="center">mediator</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">x</td>
<td align="center"></td>
<td align="center"></td>
<td align="center">x</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="left">job_stability_t</td>
<td align="center">mediator</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">x</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="left">married</td>
<td align="center">mediator</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">x</td>
<td align="center"></td>
<td align="center"></td>
<td align="center">x</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="left">pref</td>
<td align="center">nco</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">x</td>
</tr>
<tr class="odd">
<td align="left">urban</td>
<td align="center">confounder</td>
<td align="center"></td>
<td align="center"></td>
<td align="center">x</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
</tbody>
</table>
<div class="section level3">
<h3 id="models">Models<a class="anchor" aria-label="anchor" href="#models"></a>
</h3>
<table class="table">
<colgroup>
<col width="13%">
<col width="8%">
<col width="12%">
<col width="8%">
<col width="13%">
<col width="8%">
<col width="13%">
<col width="8%">
<col width="13%">
</colgroup>
<thead><tr class="header">
<th align="left">Term</th>
<th align="center">Original</th>
<th align="center">Original (ATE)</th>
<th align="center">Bivariate</th>
<th align="center">Bivariate (ATE)</th>
<th align="center">Minimal 1</th>
<th align="center">Minimal 1 (ATE)</th>
<th align="center">Canonical</th>
<th align="center">Canonical (ATE)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">edu_year</td>
<td align="center">-0.122***</td>
<td align="center">-0.115***</td>
<td align="center">0.060***</td>
<td align="center">-0.016</td>
<td align="center">-0.080***</td>
<td align="center">-0.031*</td>
<td align="center">-0.080***</td>
<td align="center">-0.020</td>
</tr>
<tr class="even">
<td align="left"> </td>
<td align="center">(0.015)</td>
<td align="center">(0.015)</td>
<td align="center">(0.014)</td>
<td align="center">(0.015)</td>
<td align="center">(0.013)</td>
<td align="center">(0.014)</td>
<td align="center">(0.013)</td>
<td align="center">(0.014)</td>
</tr>
<tr class="odd">
<td align="left">age</td>
<td align="center">0.070***</td>
<td align="center">0.057***</td>
<td align="center"></td>
<td align="center"></td>
<td align="center">0.095***</td>
<td align="center">0.095***</td>
<td align="center">0.096***</td>
<td align="center">0.095***</td>
</tr>
<tr class="even">
<td align="left"> </td>
<td align="center">(0.004)</td>
<td align="center">(0.005)</td>
<td align="center"></td>
<td align="center"></td>
<td align="center">(0.003)</td>
<td align="center">(0.004)</td>
<td align="center">(0.003)</td>
<td align="center">(0.004)</td>
</tr>
<tr class="odd">
<td align="left">genderMale</td>
<td align="center">0.181*</td>
<td align="center">-0.349***</td>
<td align="center"></td>
<td align="center"></td>
<td align="center">0.179*</td>
<td align="center">-0.467***</td>
<td align="center">0.190*</td>
<td align="center">-0.404***</td>
</tr>
<tr class="even">
<td align="left"> </td>
<td align="center">(0.085)</td>
<td align="center">(0.087)</td>
<td align="center"></td>
<td align="center"></td>
<td align="center">(0.087)</td>
<td align="center">(0.090)</td>
<td align="center">(0.085)</td>
<td align="center">(0.089)</td>
</tr>
<tr class="odd">
<td align="left">immigrantYes</td>
<td align="center">-0.246+</td>
<td align="center">-0.336*</td>
<td align="center"></td>
<td align="center"></td>
<td align="center">-0.172</td>
<td align="center">-0.284*</td>
<td align="center">-0.243+</td>
<td align="center">-0.366*</td>
</tr>
<tr class="even">
<td align="left"> </td>
<td align="center">(0.128)</td>
<td align="center">(0.140)</td>
<td align="center"></td>
<td align="center"></td>
<td align="center">(0.131)</td>
<td align="center">(0.144)</td>
<td align="center">(0.129)</td>
<td align="center">(0.142)</td>
</tr>
<tr class="odd">
<td align="left">urbanUrban</td>
<td align="center">0.121</td>
<td align="center">0.052</td>
<td align="center"></td>
<td align="center"></td>
<td align="center">0.238*</td>
<td align="center">0.200+</td>
<td align="center">0.175+</td>
<td align="center">0.178+</td>
</tr>
<tr class="even">
<td align="left"> </td>
<td align="center">(0.094)</td>
<td align="center">(0.101)</td>
<td align="center"></td>
<td align="center"></td>
<td align="center">(0.096)</td>
<td align="center">(0.103)</td>
<td align="center">(0.094)</td>
<td align="center">(0.102)</td>
</tr>
<tr class="odd">
<td align="left">birth_control</td>
<td align="center">0.133</td>
<td align="center">0.012</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="left"> </td>
<td align="center">(0.103)</td>
<td align="center">(0.111)</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="left">income</td>
<td align="center">0.000</td>
<td align="center">0.000**</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="left"> </td>
<td align="center">(0.000)</td>
<td align="center">(0.000)</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="left">married</td>
<td align="center">0.703***</td>
<td align="center">0.792***</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="left"> </td>
<td align="center">(0.122)</td>
<td align="center">(0.123)</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="left">job_stability_t</td>
<td align="center">0.285***</td>
<td align="center">0.518***</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="left"> </td>
<td align="center">(0.047)</td>
<td align="center">(0.049)</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="left">contractTemporary</td>
<td align="center">0.710***</td>
<td align="center">0.670***</td>
<td align="center"></td>
<td align="center"></td>
<td align="center">0.772***</td>
<td align="center">0.800***</td>
<td align="center">0.804***</td>
<td align="center">0.785***</td>
</tr>
<tr class="even">
<td align="left"> </td>
<td align="center">(0.110)</td>
<td align="center">(0.111)</td>
<td align="center"></td>
<td align="center"></td>
<td align="center">(0.112)</td>
<td align="center">(0.113)</td>
<td align="center">(0.110)</td>
<td align="center">(0.111)</td>
</tr>
<tr class="odd">
<td align="left">contractPermanent</td>
<td align="center">0.893***</td>
<td align="center">0.290*</td>
<td align="center"></td>
<td align="center"></td>
<td align="center">1.116***</td>
<td align="center">0.743***</td>
<td align="center">1.093***</td>
<td align="center">0.643***</td>
</tr>
<tr class="even">
<td align="left"> </td>
<td align="center">(0.114)</td>
<td align="center">(0.118)</td>
<td align="center"></td>
<td align="center"></td>
<td align="center">(0.113)</td>
<td align="center">(0.117)</td>
<td align="center">(0.111)</td>
<td align="center">(0.116)</td>
</tr>
<tr class="odd">
<td align="left">pref</td>
<td align="center">0.581***</td>
<td align="center">0.544***</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">0.578***</td>
<td align="center">0.499***</td>
</tr>
<tr class="even">
<td align="left"> </td>
<td align="center">(0.042)</td>
<td align="center">(0.046)</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">(0.042)</td>
<td align="center">(0.047)</td>
</tr>
<tr class="odd">
<td align="left">Num.Obs.</td>
<td align="center">5000</td>
<td align="center">5000</td>
<td align="center">5000</td>
<td align="center">5000</td>
<td align="center">5000</td>
<td align="center">5000</td>
<td align="center">5000</td>
<td align="center">5000</td>
</tr>
<tr class="even">
<td align="left">R2</td>
<td align="center">0.227</td>
<td align="center">0.192</td>
<td align="center">0.004</td>
<td align="center">0.000</td>
<td align="center">0.183</td>
<td align="center">0.140</td>
<td align="center">0.213</td>
<td align="center">0.159</td>
</tr>
</tbody>
</table>
<div class="section level4">
<h4 id="notes">Notes<a class="anchor" aria-label="anchor" href="#notes"></a>
</h4>
<ul>
<li>Roles legend: X (exposure); Y (outcome); CON (confounder); MED
(mediator); COL (collider); dOut (proper descendant of Y); dMed (proper
descendant of any mediator); dCol (proper descendant of any collider);
dConfOn (descendant of a confounder on a back-door path); dConfOff
(descendant of a confounder off a back-door path); NCT (neutral control
on treatment); NCO (neutral control on outcome).</li>
<li>p-value legend: + &lt; 0.1, * &lt; 0.05, ** &lt; 0.01, *** &lt;
0.001.</li>
<li>Controls (minimal): {age, class, contract, gender, immigrant,
urban}.</li>
<li>Controls (canonical): {age, class, contract, gender, immigrant,
pref, urban}.</li>
</ul>
<div class="figure">
<img src="estimand-recovery_files/figure-html/dwplot-1.png" class="r-plt" alt="*Visualizing the effect of estimand recovery*" width="768"><p class="caption">
<em>Visualizing the effect of estimand recovery</em>
</p>
</div>
<p>In some cases, the target estimand is the average controlled direct
effect. <code>DAGassist</code> supports recovering the controlled direct
effect using sequential g-estimation via integration with the
<code>DirectEffects</code> R package.</p>
<p>Using the prior example, we can use <code>DAGassist</code> to
estimate the effect of years of education on a person’s number of
children, except through birth control, income, and marital status.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mattblackwell.github.io/DirectEffects/" class="external-link">DirectEffects</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Registered S3 method overwritten by 'DirectEffects':</span></span>
<span><span class="co">#&gt;   method    from     </span></span>
<span><span class="co">#&gt;   vcov.seqg DAGassist</span></span>
<span></span>
<span><span class="fu"><a href="../reference/DAGassist.html">DAGassist</a></span><span class="op">(</span><span class="va">dag_model</span>,</span>
<span>          formula <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">children</span> <span class="op">~</span> <span class="va">edu_year</span> <span class="op">+</span> <span class="va">age</span> <span class="op">+</span> <span class="va">class</span> <span class="op">+</span> <span class="va">gender</span> <span class="op">+</span> </span>
<span>                         <span class="va">immigrant</span> <span class="op">+</span> <span class="va">urban</span> <span class="op">+</span> <span class="va">birth_control</span> <span class="op">+</span> <span class="va">income</span> <span class="op">+</span> </span>
<span>                         <span class="va">married</span> <span class="op">+</span> <span class="va">job_stability_t</span> <span class="op">+</span> <span class="va">contract</span> <span class="op">+</span> <span class="va">pref</span>, data <span class="op">=</span> <span class="va">dat</span><span class="op">)</span>,</span>
<span>          estimand <span class="op">=</span> <span class="st">"ACDE"</span><span class="op">)</span></span>
<span><span class="co">#&gt; DAGassist Report: </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Roles:</span></span>
<span><span class="co">#&gt; variable         role        Exp.  Out.  conf  med  col  dOut  dMed  dCol  dConfOn  dConfOff  NCT  NCO</span></span>
<span><span class="co">#&gt; edu_year         exposure    x                                                                        </span></span>
<span><span class="co">#&gt; children         outcome           x                                                                  </span></span>
<span><span class="co">#&gt; age              confounder              x                                                            </span></span>
<span><span class="co">#&gt; class            confounder              x                                                            </span></span>
<span><span class="co">#&gt; contract         confounder              x                                                            </span></span>
<span><span class="co">#&gt; gender           confounder              x                                                            </span></span>
<span><span class="co">#&gt; immigrant        confounder              x                                                            </span></span>
<span><span class="co">#&gt; urban            confounder              x                                                            </span></span>
<span><span class="co">#&gt; birth_control    mediator                      x               x                                      </span></span>
<span><span class="co">#&gt; income           mediator                      x               x                                      </span></span>
<span><span class="co">#&gt; job_stability_t  mediator                      x                                                      </span></span>
<span><span class="co">#&gt; married          mediator                      x               x                                      </span></span>
<span><span class="co">#&gt; pref             nco                                                                               x  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  (!) Bad controls in your formula: {birth_control, income, married, job_stability_t}</span></span>
<span><span class="co">#&gt; Minimal controls 1: {age, class, contract, gender, immigrant, urban}</span></span>
<span><span class="co">#&gt; Canonical controls: {age, class, contract, gender, immigrant, pref, urban}</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Formulas:</span></span>
<span><span class="co">#&gt;   original:  children ~ edu_year + age + class + gender + immigrant + urban +     birth_control + income + married + job_stability_t + contract +     pref</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ACDE setup:</span></span>
<span><span class="co">#&gt;   FE-collinear dropped: (none)</span></span>
<span><span class="co">#&gt;   Formulas (sequential_g):</span></span>
<span><span class="co">#&gt;    - Original: children ~ edu_year + age + class + gender + immigrant + urban + contract + pref | job_stability_t | birth_control + income + married</span></span>
<span><span class="co">#&gt;    - Minimal 1: children ~ edu_year + age + class + contract + gender + immigrant + urban | job_stability_t | birth_control + income + married</span></span>
<span><span class="co">#&gt;    - Canonical: children ~ edu_year + age + class + contract + gender + immigrant + pref + urban | job_stability_t | birth_control + income + married</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model comparison:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; +-------------------+-----------+-----------+-----------+-----------------+------------------+------------------+</span></span>
<span><span class="co">#&gt; |                   | Original  | Minimal 1 | Canonical | Original (ACDE) | Minimal 1 (ACDE) | Canonical (ACDE) |</span></span>
<span><span class="co">#&gt; +===================+===========+===========+===========+=================+==================+==================+</span></span>
<span><span class="co">#&gt; | edu_year          | -0.122*** | -0.080*** | -0.080*** | -0.084***       | -0.083***        | -0.084***        |</span></span>
<span><span class="co">#&gt; +-------------------+-----------+-----------+-----------+-----------------+------------------+------------------+</span></span>
<span><span class="co">#&gt; |                   | (0.015)   | (0.013)   | (0.013)   | (0.010)         | (0.010)          | (0.010)          |</span></span>
<span><span class="co">#&gt; +-------------------+-----------+-----------+-----------+-----------------+------------------+------------------+</span></span>
<span><span class="co">#&gt; | age               | 0.070***  | 0.095***  | 0.096***  | 0.077***        | 0.076***         | 0.077***         |</span></span>
<span><span class="co">#&gt; +-------------------+-----------+-----------+-----------+-----------------+------------------+------------------+</span></span>
<span><span class="co">#&gt; |                   | (0.004)   | (0.003)   | (0.003)   | (0.003)         | (0.003)          | (0.003)          |</span></span>
<span><span class="co">#&gt; +-------------------+-----------+-----------+-----------+-----------------+------------------+------------------+</span></span>
<span><span class="co">#&gt; | genderMale        | 0.181*    | 0.179*    | 0.190*    | 0.185*          | 0.174*           | 0.185*           |</span></span>
<span><span class="co">#&gt; +-------------------+-----------+-----------+-----------+-----------------+------------------+------------------+</span></span>
<span><span class="co">#&gt; |                   | (0.085)   | (0.087)   | (0.085)   | (0.085)         | (0.086)          | (0.085)          |</span></span>
<span><span class="co">#&gt; +-------------------+-----------+-----------+-----------+-----------------+------------------+------------------+</span></span>
<span><span class="co">#&gt; | immigrantYes      | -0.246+   | -0.172    | -0.243+   | -0.237*         | -0.166           | -0.237*          |</span></span>
<span><span class="co">#&gt; +-------------------+-----------+-----------+-----------+-----------------+------------------+------------------+</span></span>
<span><span class="co">#&gt; |                   | (0.128)   | (0.131)   | (0.129)   | (0.115)         | (0.116)          | (0.115)          |</span></span>
<span><span class="co">#&gt; +-------------------+-----------+-----------+-----------+-----------------+------------------+------------------+</span></span>
<span><span class="co">#&gt; | urbanUrban        | 0.121     | 0.238*    | 0.175+    | 0.156+          | 0.224*           | 0.156+           |</span></span>
<span><span class="co">#&gt; +-------------------+-----------+-----------+-----------+-----------------+------------------+------------------+</span></span>
<span><span class="co">#&gt; |                   | (0.094)   | (0.096)   | (0.094)   | (0.090)         | (0.092)          | (0.090)          |</span></span>
<span><span class="co">#&gt; +-------------------+-----------+-----------+-----------+-----------------+------------------+------------------+</span></span>
<span><span class="co">#&gt; | birth_control     | 0.133     |           |           |                 |                  |                  |</span></span>
<span><span class="co">#&gt; +-------------------+-----------+-----------+-----------+-----------------+------------------+------------------+</span></span>
<span><span class="co">#&gt; |                   | (0.103)   |           |           |                 |                  |                  |</span></span>
<span><span class="co">#&gt; +-------------------+-----------+-----------+-----------+-----------------+------------------+------------------+</span></span>
<span><span class="co">#&gt; | income            | 0.000     |           |           |                 |                  |                  |</span></span>
<span><span class="co">#&gt; +-------------------+-----------+-----------+-----------+-----------------+------------------+------------------+</span></span>
<span><span class="co">#&gt; |                   | (0.000)   |           |           |                 |                  |                  |</span></span>
<span><span class="co">#&gt; +-------------------+-----------+-----------+-----------+-----------------+------------------+------------------+</span></span>
<span><span class="co">#&gt; | married           | 0.703***  |           |           |                 |                  |                  |</span></span>
<span><span class="co">#&gt; +-------------------+-----------+-----------+-----------+-----------------+------------------+------------------+</span></span>
<span><span class="co">#&gt; |                   | (0.122)   |           |           |                 |                  |                  |</span></span>
<span><span class="co">#&gt; +-------------------+-----------+-----------+-----------+-----------------+------------------+------------------+</span></span>
<span><span class="co">#&gt; | job_stability_t   | 0.285***  |           |           |                 |                  |                  |</span></span>
<span><span class="co">#&gt; +-------------------+-----------+-----------+-----------+-----------------+------------------+------------------+</span></span>
<span><span class="co">#&gt; |                   | (0.047)   |           |           |                 |                  |                  |</span></span>
<span><span class="co">#&gt; +-------------------+-----------+-----------+-----------+-----------------+------------------+------------------+</span></span>
<span><span class="co">#&gt; | contractTemporary | 0.710***  | 0.772***  | 0.804***  | 0.792***        | 0.766***         | 0.792***         |</span></span>
<span><span class="co">#&gt; +-------------------+-----------+-----------+-----------+-----------------+------------------+------------------+</span></span>
<span><span class="co">#&gt; |                   | (0.110)   | (0.112)   | (0.110)   | (0.102)         | (0.103)          | (0.102)          |</span></span>
<span><span class="co">#&gt; +-------------------+-----------+-----------+-----------+-----------------+------------------+------------------+</span></span>
<span><span class="co">#&gt; | contractPermanent | 0.893***  | 1.116***  | 1.093***  | 1.055***        | 1.091***         | 1.055***         |</span></span>
<span><span class="co">#&gt; +-------------------+-----------+-----------+-----------+-----------------+------------------+------------------+</span></span>
<span><span class="co">#&gt; |                   | (0.114)   | (0.113)   | (0.111)   | (0.102)         | (0.104)          | (0.102)          |</span></span>
<span><span class="co">#&gt; +-------------------+-----------+-----------+-----------+-----------------+------------------+------------------+</span></span>
<span><span class="co">#&gt; | pref              | 0.581***  |           | 0.578***  | 0.577***        |                  | 0.577***         |</span></span>
<span><span class="co">#&gt; +-------------------+-----------+-----------+-----------+-----------------+------------------+------------------+</span></span>
<span><span class="co">#&gt; |                   | (0.042)   |           | (0.042)   | (0.046)         |                  | (0.046)          |</span></span>
<span><span class="co">#&gt; +-------------------+-----------+-----------+-----------+-----------------+------------------+------------------+</span></span>
<span><span class="co">#&gt; | Num.Obs.          | 5000      | 5000      | 5000      | 5000            | 5000             | 5000             |</span></span>
<span><span class="co">#&gt; +-------------------+-----------+-----------+-----------+-----------------+------------------+------------------+</span></span>
<span><span class="co">#&gt; | R2                | 0.227     | 0.183     | 0.213     |                 |                  |                  |</span></span>
<span><span class="co">#&gt; +===================+===========+===========+===========+=================+==================+==================+</span></span>
<span><span class="co">#&gt; | + p &lt; 0.1, * p &lt; 0.05, ** p &lt; 0.01, *** p &lt; 0.001                                                             |</span></span>
<span><span class="co">#&gt; +===================+===========+===========+===========+=================+==================+==================+ </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Roles legend: Exp. = exposure; Out. = outcome; CON = confounder; MED = mediator; COL = collider; dOut = descendant of outcome; dMed  = descendant of mediator; dCol = descendant of collider; dConfOn = descendant of a confounder on a back-door path; dConfOff = descendant of a confounder off a back-door path; NCT = neutral control on treatment; NCO = neutral control on outcome</span></span></code></pre></div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Graham Goff, Michael Denly.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
